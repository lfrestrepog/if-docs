"use strict";(self.webpackChunkgreen_software_training=self.webpackChunkgreen_software_training||[]).push([[468],{4137:(e,n,t)=>{t.d(n,{Zo:()=>s,kt:()=>m});var i=t(7294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function r(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,i,a=function(e,n){if(null==e)return{};var t,i,a={},o=Object.keys(e);for(i=0;i<o.length;i++)t=o[i],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)t=o[i],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var u=i.createContext({}),p=function(e){var n=i.useContext(u),t=n;return e&&(t="function"==typeof e?e(n):r(r({},n),e)),t},s=function(e){var n=p(e.components);return i.createElement(u.Provider,{value:n},e.children)},c={inlineCode:"code",wrapper:function(e){var n=e.children;return i.createElement(i.Fragment,{},n)}},d=i.forwardRef((function(e,n){var t=e.components,a=e.mdxType,o=e.originalType,u=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),d=p(t),m=a,h=d["".concat(u,".").concat(m)]||d[m]||c[m]||o;return t?i.createElement(h,r(r({ref:n},s),{},{components:t})):i.createElement(h,r({ref:n},s))}));function m(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var o=t.length,r=new Array(o);r[0]=d;var l={};for(var u in n)hasOwnProperty.call(n,u)&&(l[u]=n[u]);l.originalType=e,l.mdxType="string"==typeof e?e:a,r[1]=l;for(var p=2;p<o;p++)r[p]=t[p];return i.createElement.apply(null,r)}return i.createElement.apply(null,t)}d.displayName="MDXCreateElement"},7003:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>u,contentTitle:()=>r,default:()=>c,frontMatter:()=>o,metadata:()=>l,toc:()=>p});var i=t(7462),a=(t(7294),t(4137));const o={"sidebar-position":2},r="Manifest File",l={unversionedId:"major-concepts/manifest-file",id:"major-concepts/manifest-file",title:"Manifest File",description:"Manifest files are fundamental to Impact Framework and they serve multiple important purposes, including:",source:"@site/docs/major-concepts/manifest-file.md",sourceDirName:"major-concepts",slug:"/major-concepts/manifest-file",permalink:"/major-concepts/manifest-file",draft:!1,editUrl:"https://github.com/Green-Software-Foundation/if-docs/edit/master/docs/major-concepts/manifest-file.md",tags:[],version:"current",frontMatter:{"sidebar-position":2},sidebar:"tutorialSidebar",previous:{title:"Impact Engine (CLI)",permalink:"/major-concepts/if"},next:{title:"Plugins",permalink:"/major-concepts/plugins"}},u={},p=[{value:"Structure of a manifest file",id:"structure-of-a-manifest-file",level:2},{value:"Overview",id:"overview",level:3},{value:"Context",id:"context",level:3},{value:"Metadata",id:"metadata",level:4},{value:"Initialize",id:"initialize",level:4},{value:"Execution (auto-generated)",id:"execution-auto-generated",level:4},{value:"Explain",id:"explain",level:3},{value:"Tree",id:"tree",level:3},{value:"Defaults",id:"defaults",level:4},{value:"Inputs",id:"inputs",level:4},{value:"Creating input data",id:"creating-input-data",level:2},{value:"Regrouping a manifest file",id:"regrouping-a-manifest-file",level:2},{value:"Computing a manifest file",id:"computing-a-manifest-file",level:2},{value:"Running combinations of phases",id:"running-combinations-of-phases",level:2},{value:"Outputs",id:"outputs",level:2}],s={toc:p};function c(e){let{components:n,...o}=e;return(0,a.kt)("wrapper",(0,i.Z)({},s,o,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"manifest-file"},"Manifest File"),(0,a.kt)("p",null,"Manifest files are fundamental to Impact Framework and they serve multiple important purposes, including:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"They contain all the necessary configurations for Impact Framework"),(0,a.kt)("li",{parentName:"ul"},"They define your application architecture"),(0,a.kt)("li",{parentName:"ul"},"They hold your input data"),(0,a.kt)("li",{parentName:"ul"},"They are shareable, portable and human-readable"),(0,a.kt)("li",{parentName:"ul"},"They can be used as verifiable audits form your application")),(0,a.kt)("p",null,"The manifest is a ",(0,a.kt)("a",{parentName:"p",href:"https://circleci.com/blog/what-is-yaml-a-beginner-s-guide/"},"yaml")," file with a particular structure.\nIt can be thought of as an ",(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("em",{parentName:"strong"},"executable audit"))," because the file itself can be shared with others and re-executed to verify your environmental impact calculations."),(0,a.kt)("p",null,"It is a formal report detailing not just the end impact but all the assumptions, inputs, and plugins used in calculating the impact."),(0,a.kt)("p",null,"This is possible because ",(0,a.kt)("em",{parentName:"p"},"all the configuration and data required to run Impact Framework is contained in the manifest file"),"."),(0,a.kt)("p",null,"Anyone can download Impact Framework and execute a manifest file to verify the results."),(0,a.kt)("h2",{id:"structure-of-a-manifest-file"},"Structure of a manifest file"),(0,a.kt)("h3",{id:"overview"},"Overview"),(0,a.kt)("p",null,"Manifest files can be simple or very intricate, depending on the plugin pipeline you want to use and the complexity of your application. However, all manifest files conform to a basic structure that looks as follows:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml"},"name:\ndescription:\ntags:\ninitialize:\n  plugins:\n    <PLUGIN-NAME-HERE>:\n      method:\n      path:\ntree:\n  children:\n    child:\n      pipeline:\n        observe:\n        regroup:\n        compute:\n      config:\n      defaults:\n      inputs:\n        - timestamp: 2023-08-06T00:00\n          duration: 3600\n")),(0,a.kt)("p",null,"Everything above the ",(0,a.kt)("inlineCode",{parentName:"p"},"tree")," is collectively referred to as the ",(0,a.kt)("inlineCode",{parentName:"p"},"context"),". The ",(0,a.kt)("inlineCode",{parentName:"p"},"tree")," contains the input data and is structured according to the architecture of the application being examined, with individual components being nodes in the tree. Individual components can be grouped under parent nodes."),(0,a.kt)("h3",{id:"context"},"Context"),(0,a.kt)("h4",{id:"metadata"},"Metadata"),(0,a.kt)("p",null,"The global metadata includes the ",(0,a.kt)("inlineCode",{parentName:"p"},"name"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"description"),", and ",(0,a.kt)("inlineCode",{parentName:"p"},"tags")," that can be used to describe the nature of the manifest file. For example, you might name the file ",(0,a.kt)("inlineCode",{parentName:"p"},"Carbon Jan 2024")," or similar. A short description might briefly outline the scope of the manifest file, e.g. ",(0,a.kt)("inlineCode",{parentName:"p"},"company x's carbon emissions due to web serves from Jab 24 - July 24"),". Tags can be used to group manifest files (we do not explicitly use this field for anything currently)."),(0,a.kt)("h4",{id:"initialize"},"Initialize"),(0,a.kt)("p",null,"The initialize section is where you define which plugins will be used in your manifest file and provide the global configuration for them. Below is sample for initialization:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml"},"initialize:\n  plugins:\n    <PLUGIN-NAME-HERE>:\n      method: <METHOD-NAME-HERE>\n")),(0,a.kt)("p",null,"Where required values are:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"method"),": the name of the function exported by the plugin."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"path"),": the path to the plugin code. For example, for a plugin from our standard library, this value would be ",(0,a.kt)("inlineCode",{parentName:"li"},"builtin"))),(0,a.kt)("p",null,"There is also an optional ",(0,a.kt)("inlineCode",{parentName:"p"},"global-config")," field that can be used to set ",(0,a.kt)("em",{parentName:"p"},"global")," configuration that is common to a plugin wherever it is invoked across the entire manifest file."),(0,a.kt)("p",null,"Impact Framework uses the ",(0,a.kt)("inlineCode",{parentName:"p"},"initialize")," section to instantiate each plugin. A plugin cannot be invoked elsewhere in the manifest file unless it is included in this section."),(0,a.kt)("p",null,"There is also the option to provide a mapping to the plugin in the initialize block. Its purpose is to rename the arguments expected or returned from the plugin as part of the plugin's execution, avoiding the need to use additional plugins to rename parameters."),(0,a.kt)("p",null,"For example, your plugin might expect cpu/energy and your input data has the parameter cpu-energy returned from another plugin. Instead of using an additional plugin to rename the parameter and add a new one, you can use mapping to:"),(0,a.kt)("p",null,"a) rename the output from the first plugin so that cpu/energy is returned instead of the default cpu-energy"),(0,a.kt)("p",null,"b) instruct the second plugin to accept cpu-energy instead of the default cpu/energy"),(0,a.kt)("p",null,"e.g. "),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml"},"initialize:\n  plugins:\n    sci:\n      kind: plugin\n      method: Sci\n      path: 'builtin'\n      config:\n        functional-unit: requests\n      mapping:\n        sci: if-sci\n")),(0,a.kt)("p",null,"In the outputs, the ",(0,a.kt)("inlineCode",{parentName:"p"},"sci")," value returned by the Sci plugin will be named if-sci."),(0,a.kt)("p",null,"You can also add information to the plugin's initialize section about parameter metadata if you wish to add or override the metadata hardcoded into the plugin. This is what will be reported by the ",(0,a.kt)("inlineCode",{parentName:"p"},"explainer")," feature if you enable it. E.g."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml"},'plugins:\n  "sum-carbon":\n      path: "builtin"\n      method: Sum\n      global-config:\n      input-parameters:\n          - carbon-operational\n          - carbon-embodied\n      output-parameter: carbon\n      parameter-metadata:\n      inputs:\n          carbon-operational:\n          description: "carbon emitted due to an application\'s execution"\n          unit: "gCO2eq"\n          aggregation-method: \'sum\',\n          carbon-embodied:\n          description: "carbon emitted during the production, distribution and disposal of a hardware component, scaled by the fraction of the component\'s lifespan being allocated to the application under investigation"\n          unit: "gCO2eq"\n          aggregation-method: \'sum\'\n')),(0,a.kt)("h4",{id:"execution-auto-generated"},"Execution (auto-generated)"),(0,a.kt)("p",null,"This section is auto generated by IF at runtime. You don't have to include this section in your manifest. The ",(0,a.kt)("inlineCode",{parentName:"p"},"execution")," node contains all the necessary information to rebuild the environment, which can support debugging or verifying output files."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml"},"execution:\n  status: success\n  command: if-run --manifest examples/basic.yml\n  environment:\n    if-version: v0.3.2\n    os: ubuntu\n    os-version: 22.04.6\n    node-version: v21.4.0\n    date-time: 2023-12-12T00:00:00.000Z (UTC)\n    dependencies:\n      - '@babel/core@7.22.10'\n      - ...\n  error: 'InputValidationError:   \"duration\" parameter is required. Error code: invalid_type'. ## appears when execution failed\n")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"status"),": execution state: ",(0,a.kt)("inlineCode",{parentName:"li"},"success")," (indicating that IF successfully executed this manifest) or ",(0,a.kt)("inlineCode",{parentName:"li"},"fail")," (indicating that IF encountered a problem that halted execution)."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"command"),": exact command which was used to run the framework to execute this manifest (it may include full path to tools in place of aliases such as ",(0,a.kt)("inlineCode",{parentName:"li"},"run"),")"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"environment"),": information about the environment the manifest was executed in, including the local operating system, Node.js version, time, and dependencies."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"error"),": this field only appears if execution failed. The error message returned by IF is captured here.")),(0,a.kt)("h3",{id:"explain"},"Explain"),(0,a.kt)("p",null,"This section is autogenerated at runtime. It is a list of all the parameter metadata that IF can scrape from your plugin instances. It looks as follows:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml"},"explain:\n  sci:\n    method: Sci\n    path: builtin\n    inputs:\n      carbon:\n        unit: gCO2eq\n        description: >-\n          total carbon emissions attributed to an application's usage as the sum\n          of embodied and operational carbon\n        aggregation-method: 'sum'\n      requests:\n        unit: requests\n        description: number of requests made to application in the given timestep\n        aggregation-method: 'sum'\n    outputs:\n      sci:\n        unit: gCO2eq/request\n        description: >-\n          software carbon intensity expressed as a rate of carbon emission per\n          request\n        aggregation-method: 'sum'\n")),(0,a.kt)("h3",{id:"tree"},"Tree"),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"tree")," section of a manifest file defines the topology of all the components being measured. The shape of the ",(0,a.kt)("inlineCode",{parentName:"p"},"tree")," defines the grouping of components. It describes the architecture of the application being studied and contains all the usage observations for each component. The tree has individual components such as leaves, intermediate nodes representing groupings, and the top level is the root."),(0,a.kt)("p",null,(0,a.kt)("img",{src:t(403).Z,width:"614",height:"569"})),(0,a.kt)("p",null,"For example, a web application could be organized as follows:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"tree:\n  children:\n    front-end:\n      children:\n        build-pipeline:\n          children:\n            vercel:\n            github-pages:\n    backend-database:\n      children:\n        server1:\n        server2:\n        server3:\n    front-end:\n    networking:\n")),(0,a.kt)("p",null,"This example has a relatively straightforward structure with a maximum of 3 levels of nesting. You can continue to nest components to any depth."),(0,a.kt)("p",null,"Each component has some configuration, some input data, and a plugin pipeline."),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"pipeline"),": a list of plugins that should be executed for a specific component. This is broken down into three subsections representing distinct phases of execution that can be triggered independently using command line flags. These subsections are:",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"observe"),": the plugins that generate input data"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"regroup"),": configuration for regrouping input data by given keys"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"compute"),": the plugins that operate over input data and generate output data"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"defaults"),": fallback values that IF defaults to if they are not present in an input observation."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"inputs"),": an array of ",(0,a.kt)("inlineCode",{parentName:"li"},"observation")," data, with each ",(0,a.kt)("inlineCode",{parentName:"li"},"observation")," containing usage data for a given timestep.")),(0,a.kt)("p",null,"If a component ",(0,a.kt)("em",{parentName:"p"},"does not")," include its own ",(0,a.kt)("inlineCode",{parentName:"p"},"pipeline")," or ",(0,a.kt)("inlineCode",{parentName:"p"},"default")," values, they are inherited from the closest parent."),(0,a.kt)("p",null,"Here's an example of a moderately complex tree:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml"},"tree:\n  children:\n    child-0:\n      children:\n        child-0-1:\n          pipeline:\n            observe:\n            regroup:\n            compute:\n              - sum\n          config: null\n          defaults: null\n          inputs:\n            - timestamp: 2023-07-06T00:00\n              duration: 10\n              cpu-util: 50\n              energy-network: 0.000811\n          outputs:\n            - timestamp: 2023-07-06T00:00\n              duration: 10\n              cpu-util: 50\n              energy-network: 0.000811\n              energy: 0.000811\n        child-0-2:\n          children:\n            child-0-2-1:\n              pipeline:\n               observe:\n               regroup:\n               compute:\n                  - sum\n              config: null\n              defaults: null\n              inputs:\n                - timestamp: 2023-07-06T00:00\n                  duration: 10\n                  cpu-util: 50\n                  energy-network: 0.000811\n              outputs:\n                - timestamp: 2023-07-06T00:00\n                  duration: 10\n                  cpu-util: 50\n                  energy-network: 0.000811\n                  energy: 0.000811\n")),(0,a.kt)("h4",{id:"defaults"},"Defaults"),(0,a.kt)("p",null,"Defaults are fallback values that are only used if a given value is missing in the inputs array. For example, if you have a value that could feasibly be missing in a given timestep, perhaps because your plugin relies on a third party API that can fail, you can provide a value in ",(0,a.kt)("inlineCode",{parentName:"p"},"defaults")," that can be used as a fallback value."),(0,a.kt)("p",null,"The values in defaults are applied to every timestep where the given value is missing. This means that as well as acting as a fallback ",(0,a.kt)("inlineCode",{parentName:"p"},"defaults")," can be used as a convenience tool for efficiently adding a constant value to every timestep in your inputs array."),(0,a.kt)("h4",{id:"inputs"},"Inputs"),(0,a.kt)("p",null,"Every component includes an ",(0,a.kt)("inlineCode",{parentName:"p"},"inputs")," field that gets read into plugins as an array. ",(0,a.kt)("inlineCode",{parentName:"p"},"inputs")," are divided into ",(0,a.kt)("inlineCode",{parentName:"p"},"observations"),", each having a ",(0,a.kt)("inlineCode",{parentName:"p"},"timestamp")," and a ",(0,a.kt)("inlineCode",{parentName:"p"},"duration"),". Every ",(0,a.kt)("inlineCode",{parentName:"p"},"observation")," refers to an element in ",(0,a.kt)("inlineCode",{parentName:"p"},"inputs")," representing some snapshot in time."),(0,a.kt)("p",null,"Each plugin takes the ",(0,a.kt)("inlineCode",{parentName:"p"},"inputs")," array and applies some calculation or transformation to each ",(0,a.kt)("inlineCode",{parentName:"p"},"observation")," in the array."),(0,a.kt)("p",null,"Observations can include any type of data, including human judgment, assumptions, other plugins, APIs, survey data or telemetry."),(0,a.kt)("p",null,"The separation of timestamps in the ",(0,a.kt)("inlineCode",{parentName:"p"},"inputs")," array determines the temporal granularity of your impact calculations. The more frequent your observations, the more accurate your impact assessment."),(0,a.kt)("h2",{id:"creating-input-data"},"Creating input data"),(0,a.kt)("p",null,"The plugins in the ",(0,a.kt)("inlineCode",{parentName:"p"},"observe")," part of the pipeline generate ",(0,a.kt)("inlineCode",{parentName:"p"},"input")," data. The manifest file should not have ",(0,a.kt)("inlineCode",{parentName:"p"},"input")," data when the ",(0,a.kt)("inlineCode",{parentName:"p"},"observe")," phase is executed. Plugins in this phase ",(0,a.kt)("em",{parentName:"p"},"only")," generate input data, they can never generate output data. If you run the observe phase on its own (by running ",(0,a.kt)("inlineCode",{parentName:"p"},"if-run --observe"),") then your manifest will be returned populated with input data according to the plugins you included in your ",(0,a.kt)("inlineCode",{parentName:"p"},"observe")," pipeline."),(0,a.kt)("h2",{id:"regrouping-a-manifest-file"},"Regrouping a manifest file"),(0,a.kt)("p",null,"The second phase of manifest execution is ",(0,a.kt)("inlineCode",{parentName:"p"},"regroup"),". This reorganizes existing ",(0,a.kt)("inlineCode",{parentName:"p"},"input")," data into a new structure using keys provided in the ",(0,a.kt)("inlineCode",{parentName:"p"},"regroup")," config in the manifest. For example, a manifest with the following ",(0,a.kt)("inlineCode",{parentName:"p"},"tree"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml"},"tree:\n  children:\n    my-app:\n      pipeline:\n        observe:\n        regroup:\n          - cloud/instance-type\n          - cloud/region\n        compute:\n      children:\n        inputs:\n          - timestamp: 2023-07-06T00:00\n            duration: 300\n            cloud/instance-type: A1\n            cloud/region: uk-west\n            cpu/utilization: 99\n          - timestamp: 2023-07-06T05:00\n            duration: 300\n            cloud/instance-type: A1\n            cloud/region: uk-west\n            cpu/utilization: 23\n          - timestamp: 2023-07-06T10:00\n            duration: 300\n            cloud/instance-type: A1\n            cloud/region: uk-west\n            cpu/utilization: 12\n          - timestamp: 2023-07-06T00:00\n            duration: 300\n            cloud/instance-type: B1\n            cloud/region: uk-west\n            cpu/utilization: 11\n          - timestamp: 2023-07-06T05:00\n            duration: 300\n            cloud/instance-type: B1\n            cloud/region: uk-west\n            cpu/utilization: 67\n          - timestamp: 2023-07-06T10:00\n            duration: 300\n            cloud/instance-type: B1\n            cloud/region: uk-west\n            cpu/utilization: 1\n          - timestamp: 2023-07-06T00:00\n            duration: 300\n            cloud/instance-type: A1\n            cloud/region: uk-east\n            cpu/utilization: 9\n          - timestamp: 2023-07-06T05:00\n            duration: 300\n            cloud/instance-type: A1\n            cloud/region: uk-east\n            cpu/utilization: 23\n          - timestamp: 2023-07-06T10:00\n            duration: 300\n            cloud/instance-type: A1\n            cloud/region: uk-east\n            cpu/utilization: 12\n          - timestamp: 2023-07-06T00:00\n            duration: 300\n            cloud/instance-type: B1\n            cloud/region: uk-east\n            cpu/utilization: 11\n          - timestamp: 2023-07-06T05:00\n            duration: 300\n            cloud/instance-type: B1\n            cloud/region: uk-east\n            cpu/utilization: 67\n          - timestamp: 2023-07-06T10:00\n            duration: 300\n            cloud/instance-type: B1\n            cloud/region: uk-east\n            cpu/utilization: 1\n\n")),(0,a.kt)("p",null,"generates the following output when ",(0,a.kt)("inlineCode",{parentName:"p"},"if-run --regroup")," is executed:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml"},"tree:\n  children:\n    my-app:\n      pipeline:\n        observe: null\n        regroup:\n          - cloud/instance-type\n          - cloud/region\n        compute: null\n      children:\n        A1:\n          children:\n            uk-west:\n              inputs:\n                - timestamp: 2023-07-06T00:00\n                  duration: 300\n                  cloud/instance-type: A1\n                  cloud/region: uk-west\n                  cpu/utilization: 99\n                - timestamp: 2023-07-06T05:00\n                  duration: 300\n                  cloud/instance-type: A1\n                  cloud/region: uk-west\n                  cpu/utilization: 23\n                - timestamp: 2023-07-06T10:00\n                  duration: 300\n                  cloud/instance-type: A1\n                  cloud/region: uk-west\n                  cpu/utilization: 12\n            uk-east:\n              inputs:\n                - timestamp: 2023-07-06T00:00\n                  duration: 300\n                  cloud/instance-type: A1\n                  cloud/region: uk-east\n                  cpu/utilization: 9\n                - timestamp: 2023-07-06T05:00\n                  duration: 300\n                  cloud/instance-type: A1\n                  cloud/region: uk-east\n                  cpu/utilization: 23\n                - timestamp: 2023-07-06T10:00\n                  duration: 300\n                  cloud/instance-type: A1\n                  cloud/region: uk-east\n                  cpu/utilization: 12\n        B1:\n          children:\n            uk-west:\n              inputs:\n                - timestamp: 2023-07-06T00:00\n                  duration: 300\n                  cloud/instance-type: B1\n                  cloud/region: uk-west\n                  cpu/utilization: 11\n                - timestamp: 2023-07-06T05:00\n                  duration: 300\n                  cloud/instance-type: B1\n                  cloud/region: uk-west\n                  cpu/utilization: 67\n                - timestamp: 2023-07-06T10:00\n                  duration: 300\n                  cloud/instance-type: B1\n                  cloud/region: uk-west\n                  cpu/utilization: 1\n            uk-east:\n              inputs:\n                - timestamp: 2023-07-06T00:00\n                  duration: 300\n                  cloud/instance-type: B1\n                  cloud/region: uk-east\n                  cpu/utilization: 11\n                - timestamp: 2023-07-06T05:00\n                  duration: 300\n                  cloud/instance-type: B1\n                  cloud/region: uk-east\n                  cpu/utilization: 67\n                - timestamp: 2023-07-06T10:00\n                  duration: 300\n                  cloud/instance-type: B1\n                  cloud/region: uk-east\n                  cpu/utilization: 1\n")),(0,a.kt)("h2",{id:"computing-a-manifest-file"},"Computing a manifest file"),(0,a.kt)("p",null,"Impact Framework computes manifest files. For each component in the tree, the ",(0,a.kt)("inlineCode",{parentName:"p"},"inputs")," array is passed to each plugin in the ",(0,a.kt)("inlineCode",{parentName:"p"},"compute")," pipeline in sequence."),(0,a.kt)("p",null,"In order for the ",(0,a.kt)("inlineCode",{parentName:"p"},"compute")," phase to execute correctly, the manifest needs to have ",(0,a.kt)("inlineCode",{parentName:"p"},"input")," data available. "),(0,a.kt)("p",null,"Each plugin ",(0,a.kt)("em",{parentName:"p"},"enriches")," the ",(0,a.kt)("inlineCode",{parentName:"p"},"inputs")," array in some specific way, typically by adding a new ",(0,a.kt)("inlineCode",{parentName:"p"},"key-value")," pair to each observation in the array. For example, the ",(0,a.kt)("inlineCode",{parentName:"p"},"teads-curve")," plugin takes in CPU utilization expressed as a percentage as an input and appends ",(0,a.kt)("inlineCode",{parentName:"p"},"cpu/energy")," expressed in kWh. ",(0,a.kt)("inlineCode",{parentName:"p"},"cpu/energy")," is then available to be passed as an input to, for example, the ",(0,a.kt)("inlineCode",{parentName:"p"},"sci-e")," plugin."),(0,a.kt)("p",null,"This implies a sequence of plugins where the inputs for some plugins must either be present in the original manifest file or be outputs of the preceding plugins in the pipeline."),(0,a.kt)("p",null,"There are also plugins and built-in features that can synchronize time series of ",(0,a.kt)("inlineCode",{parentName:"p"},"observations")," across an entire tree and aggregate data across time or across components."),(0,a.kt)("h2",{id:"running-combinations-of-phases"},"Running combinations of phases"),(0,a.kt)("p",null,"It is possible to run each phase of the execution individually, or together. You can choose to ",(0,a.kt)("em",{parentName:"p"},"only")," run the ",(0,a.kt)("inlineCode",{parentName:"p"},"observe"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"regroup")," or ",(0,a.kt)("inlineCode",{parentName:"p"},"compute")," phases of the manifest execution. This saves you from having to re-execute entire manifests every time you want to tweak something, making it a greener way to use IF."),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"if-run")," executes all the phases together, including ",(0,a.kt)("inlineCode",{parentName:"p"},"observe"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"regroup")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"compute"),". It generates yaml output data. However, you can run individual phases by passing ",(0,a.kt)("inlineCode",{parentName:"p"},"--observe"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"--regroup")," or ",(0,a.kt)("inlineCode",{parentName:"p"},"--compute")," flags on the command line. For example, to run ",(0,a.kt)("em",{parentName:"p"},"only")," the compute phase:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"if-run -m <manifest> --compute\n")),(0,a.kt)("p",null,"Maybe you only want to generate a static file that contains input data but don't want to run the full compute pipeline right now. You can run with ",(0,a.kt)("inlineCode",{parentName:"p"},"--observe"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"if-run <manifest> --observe\n")),(0,a.kt)("p",null,"You can also combine the command, e.g. if you have a file with inputs and you want to run ",(0,a.kt)("inlineCode",{parentName:"p"},"regroup")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"compute")," but not ",(0,a.kt)("inlineCode",{parentName:"p"},"observe"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"if-run -m <manifest> --regroup --compute\n")),(0,a.kt)("h2",{id:"outputs"},"Outputs"),(0,a.kt)("p",null,"When Impact Framework computes a manifest file, it appends new data to the manifest file and the final result is an enriched manifest that includes all the configuration and contextual data, the input data, and the results of executing each plugin. This means the output file is completely auditable - the original manifest file can be recovered simply by deleting the ",(0,a.kt)("inlineCode",{parentName:"p"},"outputs")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"execution")," sections of the output file."),(0,a.kt)("p",null,"IF generates yaml output data. Any other output formats have to be generated by separate exhaust scripts that take IF's yaml output as their input."),(0,a.kt)("p",null,"Here's an example output file:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml"},"name: sum\ndescription: successful path\ntags: null\ninitialize:\n  plugins:\n    sum:\n      path: builtin\n      method: Sum\n      global-config:\n        input-parameters:\n          - cpu/energy\n          - network/energy\n        output-parameter: energy\nexecution:\n  command: >-\n    /home/user/.npm/_npx/1bf7c3c15bf47d04/node_modules/.bin/ts-node\n    /home/user/Code/if/src/index.ts -m\n    /home/user/Code/if/manifests/plugins/sum/success.yml\n  environment:\n    if-version: 0.3.3-beta.0\n    os: linux\n    os-version: 5.15.0-105-generic\n    node-version: 21.4.0\n    date-time: 2024-05-31T09:18:48.895Z (UTC)\n    dependencies:\n      - '@babel/core@7.22.10'\n      - '@babel/preset-typescript@7.23.3'\n      - '@commitlint/cli@18.6.0'\n      - '@commitlint/config-conventional@18.6.0'\n      - '@jest/globals@29.7.0'\n      - '@types/jest@29.5.8'\n      - '@types/js-yaml@4.0.9'\n      - '@types/luxon@3.4.2'\n      - '@types/node@20.9.0'\n      - csv-stringify@6.4.6\n      - fixpack@4.0.0\n      - gts@5.2.0\n      - husky@8.0.3\n      - jest@29.7.0\n      - js-yaml@4.1.0\n      - lint-staged@15.2.2\n      - luxon@3.4.4\n      - release-it@16.3.0\n      - rimraf@5.0.5\n      - ts-command-line-args@2.5.1\n      - ts-jest@29.1.1\n      - typescript-cubic-spline@1.0.1\n      - typescript@5.2.2\n      - winston@3.11.0\n      - zod@3.22.4\n  status: success\ntree:\n  children:\n    child:\n      pipeline:\n        observe:\n        regroup:\n        compute:\n          - sum\n      config:\n        sum: null\n      inputs:\n        - timestamp: 2023-08-06T00:00\n          duration: 3600\n          cpu/energy: 0.001\n          network/energy: 0.001\n      outputs:\n        - timestamp: 2023-08-06T00:00\n          duration: 3600\n          cpu/energy: 0.001\n          network/energy: 0.001\n          energy: 0.002\n")))}c.isMDXComponent=!0},403:(e,n,t)=>{t.d(n,{Z:()=>i});const i=t.p+"assets/images/3f18767c1a55cee416e3de70314609e3-c7fa9feaf0993c3ed2b5a34b8b82432c.png"}}]);