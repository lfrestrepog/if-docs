"use strict";(self.webpackChunkgreen_software_training=self.webpackChunkgreen_software_training||[]).push([[890],{4137:(e,n,t)=>{t.d(n,{Zo:()=>l,kt:()=>d});var i=t(7294);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function p(e,n){if(null==e)return{};var t,i,r=function(e,n){if(null==e)return{};var t,i,r={},a=Object.keys(e);for(i=0;i<a.length;i++)t=a[i],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)t=a[i],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var s=i.createContext({}),u=function(e){var n=i.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},l=function(e){var n=u(e.components);return i.createElement(s.Provider,{value:n},e.children)},c={inlineCode:"code",wrapper:function(e){var n=e.children;return i.createElement(i.Fragment,{},n)}},m=i.forwardRef((function(e,n){var t=e.components,r=e.mdxType,a=e.originalType,s=e.parentName,l=p(e,["components","mdxType","originalType","parentName"]),m=u(t),d=r,g=m["".concat(s,".").concat(d)]||m[d]||c[d]||a;return t?i.createElement(g,o(o({ref:n},l),{},{components:t})):i.createElement(g,o({ref:n},l))}));function d(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var a=t.length,o=new Array(a);o[0]=m;var p={};for(var s in n)hasOwnProperty.call(n,s)&&(p[s]=n[s]);p.originalType=e,p.mdxType="string"==typeof e?e:r,o[1]=p;for(var u=2;u<a;u++)o[u]=t[u];return i.createElement.apply(null,o)}return i.createElement.apply(null,t)}m.displayName="MDXCreateElement"},2080:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>o,default:()=>c,frontMatter:()=>a,metadata:()=>p,toc:()=>u});var i=t(7462),r=(t(7294),t(4137));const a={"sidebar-position":7},o="Group-by",p={unversionedId:"major-concepts/groupby",id:"major-concepts/groupby",title:"Group-by",description:"Groupby is an IF plugin that reorganizes a tree according to keys provided by the user. This allows users to regroup their observations according to various properties of their application. For example, the following manifest file contains a flat array of observations. This is how you might expect data to arrive from an importer plugin, maybe one that hits a metrics API for a cloud service.",source:"@site/docs/major-concepts/groupby.md",sourceDirName:"major-concepts",slug:"/major-concepts/groupby",permalink:"/major-concepts/groupby",draft:!1,editUrl:"https://github.com/Green-Software-Foundation/ief/docs/major-concepts/groupby.md",tags:[],version:"current",frontMatter:{"sidebar-position":7},sidebar:"tutorialSidebar",previous:{title:"Design philosophy",permalink:"/major-concepts/design-philosophy"},next:{title:"Impact Engine (CLI)",permalink:"/major-concepts/if"}},s={},u=[{value:"Using <code>group-by</code>",id:"using-group-by",level:2}],l={toc:u};function c(e){let{components:n,...t}=e;return(0,r.kt)("wrapper",(0,i.Z)({},l,t,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"group-by"},"Group-by"),(0,r.kt)("p",null,"Groupby is an IF plugin that reorganizes a tree according to keys provided by the user. This allows users to regroup their observations according to various properties of their application. For example, the following manifest file contains a flat array of observations. This is how you might expect data to arrive from an importer plugin, maybe one that hits a metrics API for a cloud service."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"name: if-demo\ndescription: demo pipeline\ngraph:\n  children:\n    my-app:\n      pipeline:     \n        - group-by\n        - teads-curve\n      config:\n        group-by:\n          - cloud-region\n          - instance-type\n      inputs:\n        - timestamp: 2023-07-06T00:00\n          duration: 300 \n          instance-type: A1 \n          region: uk-west\n          cpu-util: 99\n        - timestamp: 2023-07-06T05:00 \n          duration: 300 \n          instance-type: A1 \n          region: uk-west\n          cpu-util: 23    \n        - timestamp: 2023-07-06T10:00\n          duration: 300\n          instance-type: A1 \n          region: uk-west\n          cpu-util: 12\n        - timestamp: 2023-07-06T00:00 # note this time restarts at the start timstamp\n          duration: 300 \n          instance-type: B1\n          region: uk-west\n          cpu-util: 11\n        - timestamp: 2023-07-06T05:00 \n          duration: 300 \n          instance-type: B1\n          region: uk-west\n          cpu-util: 67\n        - timestamp: 2023-07-06T10:00\n          duration: 300 \n          instance-type: B1\n          region: uk-west\n          cpu-util: 1     \n")),(0,r.kt)("p",null,"However, each observation contains an ",(0,r.kt)("inlineCode",{parentName:"p"},"instance-type")," field that varies between observations. There are two instance types being represented in this array of observations. This means there are duplicate entries for the same timestamp in this array. This is the problem that ",(0,r.kt)("inlineCode",{parentName:"p"},"group-by")," solves. You provide ",(0,r.kt)("inlineCode",{parentName:"p"},"instance-type")," as a key to the ",(0,r.kt)("inlineCode",{parentName:"p"},"group-by")," plugin and it extracts the data belonging to the different instances and separates them into independent arrays. The above example would be restructured so that instance types ",(0,r.kt)("inlineCode",{parentName:"p"},"A1")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"B1")," have their own data, as follows:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"graph:\n  children:\n    my-app:\n      pipeline:\n        # - group-by\n        - teads-curve\n      config:\n        group-by:\n          groups:\n            - cloud-region\n            - instance-type\n      children:\n        A1:\n            inputs:\n            - timestamp: 2023-07-06T00:00\n                duration: 300\n                instance-type: A1\n                region: uk-west\n                cpu-util: 99\n            - timestamp: 2023-07-06T05:00\n                duration: 300\n                instance-type: A1\n                region: uk-west\n                cpu-util: 23\n            - timestamp: 2023-07-06T10:00\n                duration: 300\n                instance-type: A1\n                region: uk-west\n                cpu-util: 12\n        B1:\n            inputs:\n            - timestamp: 2023-07-06T00:00\n                duration: 300\n                instance-type: B1\n                region: uk-east\n                cpu-util: 11\n            - timestamp: 2023-07-06T05:00\n                duration: 300\n                instance-type: B1\n                region: uk-east\n                cpu-util: 67\n            - timestamp: 2023-07-06T10:00\n                duration: 300\n                instance-type: B1\n                region: uk-east\n                cpu-util: 1          \n")),(0,r.kt)("h2",{id:"using-group-by"},"Using ",(0,r.kt)("inlineCode",{parentName:"h2"},"group-by")),(0,r.kt)("p",null,"To use ",(0,r.kt)("inlineCode",{parentName:"p"},"group-by"),", you have to initialize it as a plugin and invoke it in a pipeline."),(0,r.kt)("p",null,"The initialization looks as follows:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"initialize:\nplugins:\ngroup-by: \n    path: 'builtin'\n    method: GroupBy\n")),(0,r.kt)("p",null,"You then have to provide config defining which keys to group by in each component. This is done at the component level (i.e. not global config).\nFor example:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"tree:\n  children:\n    my-app:\n      pipeline:     \n        - group-by\n      config:\n        group-by:\n          group:\n            - region\n            - instance-type\n")),(0,r.kt)("p",null,"In the example above, the plugin would regroup the input data for the specific component by ",(0,r.kt)("inlineCode",{parentName:"p"},"region")," and by ",(0,r.kt)("inlineCode",{parentName:"p"},"instance-type"),"."),(0,r.kt)("p",null,"Assuming the values ",(0,r.kt)("inlineCode",{parentName:"p"},"A1")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"B1")," are found for ",(0,r.kt)("inlineCode",{parentName:"p"},"instance-type")," and the values ",(0,r.kt)("inlineCode",{parentName:"p"},"uk-east")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"uk-west")," are found for ",(0,r.kt)("inlineCode",{parentName:"p"},"region"),", the result of ",(0,r.kt)("inlineCode",{parentName:"p"},"group-by")," would look similar to the following:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"tree:\n  children:\n    my-app:\n      pipeline:\n        - group-by\n      config:\n        group-by:\n          groups:\n            - region\n            - instance-type\n      children:\n        uk-west:\n          children:\n            A1:\n              inputs:\n                - timestamp: 2023-07-06T00:00\n                  duration: 300\n                  instance-type: A1\n                  region: uk-west\n                  cpu-util: 99\n                - timestamp: 2023-07-06T05:00\n                  duration: 300\n                  instance-type: A1\n                  region: uk-west\n                  cpu-util: 23\n                - timestamp: 2023-07-06T10:00\n                  duration: 300\n                  instance-type: A1\n                  region: uk-west\n                  cpu-util: 12\n        uk-east:\n          children:\n            B1:\n              inputs:\n                - timestamp: 2023-07-06T00:00\n                  duration: 300\n                  instance-type: B1\n                  region: uk-east\n                  cpu-util: 11\n                - timestamp: 2023-07-06T05:00\n                  duration: 300\n                  instance-type: B1\n                  region: uk-east\n                  cpu-util: 67\n                - timestamp: 2023-07-06T10:00\n                  duration: 300\n                  instance-type: B1\n                  region: uk-east\n                  cpu-util: 1     \n")),(0,r.kt)("p",null,"This reorganized data can then be used to feed the rest of a computation pipeline."))}c.isMDXComponent=!0}}]);